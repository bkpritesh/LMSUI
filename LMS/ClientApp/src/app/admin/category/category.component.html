<div class="page-content-wrapper border">
  <div class="row mb-3">
    <div class="col-12 d-sm-flex justify-content-between align-items-center">
      <h1 class="h3 mb-2 mb-sm-0">
        Category Page
        <!--<span class="badge bg-orange bg-opacity-10 text-orange">245</span>-->
      </h1>
      <!-- Button trigger modal -->
      <button type="button" class="btn btn-sm btn-primary mb-0" data-toggle="modal"
              (click)="openAddFormmodal()">
        Create a Category
      </button>
      <!-- Button trigger modal -->
    </div>
  </div>
  <!-- Card START -->
  <div class="card bg-transparent border">
    <!-- Card header START -->
    <div class="card-header bg-light border-bottom">
      <!-- Search and select START -->
      <div class="row g-3 align-items-center justify-content-between">
        <!-- Search bar -->
        <div class="col-md-12">
          <form class="rounded position-relative">
            <input class="form-control bg-body" type="search" placeholder="Search"
                   aria-label="Search" />
            <button class="bg-transparent p-2 position-absolute top-50 end-0 translate-middle-y border-0 text-primary-hover text-reset"
                    type="submit">
              <i class="fas fa-search fs-6 "></i>
            </button>
          </form>
        </div>
      </div>
      <!-- Search and select END -->
    </div>
    <!-- Card header END -->
    <!-- Card body START -->
    <div class="card-body">
      <!-- Course table START -->
      <div class="table-responsive border-0 rounded-3">
        <!-- Table START -->
        <table class="table table-dark-gray align-middle p-4 mb-0 table-hover">
          <!-- Table head -->
          <thead>
            <tr>
              <th scope="col" class="border-0 rounded-start">#</th>
              <th scope="col" class="border-0">Category</th>
              <th scope="col" class="border-0">Description</th>
              <th scope="col" class="border-0 rounded-end">Action</th>
            </tr>
          </thead>
          <!-- Table body START -->
          <tbody>
            <!-- Table row -->
            <tr *ngFor="let cate of categories">
              <!-- Table data -->
              <td>{{cate.categoryId}}</td>
              <!-- Table data -->
              <!-- Table data -->
              <td> {{cate.name}}</td>

              <!-- Table data -->
              <td> {{cate.description}}</td>

              <!-- Table data -->
              <td>
                <button class="btn btn-sm btn-success me-1 mb-1 mb-md-0" data-bs-toggle="modal"
                        (click)="openEditFormModal(cate.categoryId)">
                  Edit
                </button>
                <button class="btn btn-sm btn-danger mb-0" [attr.cid]="cate.categoryId" (click)="openDeleteFormModal(cate.categoryId)">Delete</button>
              </td>
            </tr>
            <!-- Table row -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<!-- Popup modal for Add Category START-->
<div class="modal fade" id="addcategory" tabindex="-1" role="dialog" aria-labelledby="AddCategoryLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="AddCategoryLabel">Add Category</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closeFormModal()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="row g-3" #AddCategory="ngForm">
          <div class="mb-3">
            <label for="Category_name" class="form-label">Category Name</label>
            <input type="text" class="form-control" id="Category_name" name="Category_name" placeholder="Enter category" [(ngModel)]="category.name" required #Category_name="ngModel" ngModel>
            <div class="alert alert-danger" *ngIf="Category_name.invalid && (Category_name.dirty || Category_name.touched)">
              <div *ngIf="Category_name.errors?.['required']">
                Category is required.
              </div>
            </div>
          </div>
          <div class="mb-3">
            <label for="Category_des" class="form-label">Description</label>
            <textarea class="form-control" id="Category_des" name="Category_des" placeholder="Enter Description" [(ngModel)]="category.description" required #Category_des="ngModel" ngModel></textarea>
            <div class="alert alert-danger" *ngIf="Category_des.invalid && (Category_des.dirty || Category_des.touched)">
              <div *ngIf="Category_des.errors?.['required']">
                Category Description is required.
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="closeFormModal()">Close</button>
        <button type="submit" class="btn btn-primary" [class.disabled]="!AddCategory.valid" (click)="addCategory()">Save</button>
      </div>
    </div>
  </div>
</div>


<!-- Popup modal for Edit Category START-->
<div class="modal fade" id="editcategory" tabindex="-1" role="dialog" aria-labelledby="EditCategoryLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="EditCategoryLabel">Edit Category</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closeFormModal()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="row g-3" #EditCategory="ngForm">
          <input type="hidden" value="{{categoryId}}" [(ngModel)]="category.categoryId"/>
          <div class="mb-3">
            <label for="Edit_Category_name" class="form-label">Category Name</label>
            <input type="text" class="form-control" id="Edit_Category_name" name="Edit_Category_name" placeholder="Enter category" [(ngModel)]="category.name" required #Edit_Category_name="ngModel" ngModel>
            <div class="alert alert-danger" *ngIf="Edit_Category_name.invalid && (Edit_Category_name.dirty || Edit_Category_name.touched)">
              <div *ngIf="Edit_Category_name.errors?.['required']">
                Category is required.
              </div>
            </div>  
          </div>
          <div class="mb-3">
            <label for="Edit_Category_des" class="form-label">Description</label>
            <textarea class="form-control" id="Edit_Category_des" name="Edit_Category_des" placeholder="Enter Description" [(ngModel)]="category.description" required #Edit_Category_des="ngModel" ngModel></textarea>
            <div class="alert alert-danger" *ngIf="Edit_Category_des.invalid && (Edit_Category_des.dirty || Edit_Category_des.touched)">
              <div *ngIf="Edit_Category_des.errors?.['required']">
                Category Description is required.
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="closeFormModal()">Close</button>
        <button type="submit" class="btn btn-primary" [class.disabled]="!EditCategory.valid" (click)="editCategory()">Save</button>
      </div>
    </div>
  </div>
</div>



<!-- Popup modal for Delete Category START-->
<div class="modal fade" id="deletecategory" tabindex="-1" role="dialog" aria-labelledby="DeleteCategoryLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title w-100" id="DeleteCategoryLabel">Are you sure?</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closeFormModal()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="row g-3" #DeleteCategory>
          <input type="hidden" value="{{categoryId}}" [(ngModel)]="category.categoryId" />
          <p>Do you really want to delete these records? This process cannot be undone.</p>
        </form>
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="closeFormModal()">Cancel</button>
        <button type="submit" class="btn btn-danger" (click)="deleteCategory()">Delete</button>
      </div>
    </div>
  </div>
</div>
